DROP DATABASE shahajjo_db;
CREATE DATABASE shahajjo_db;
USE shahajjo_db;

CREATE TABLE Admin_table (
  Admin_ID VARCHAR(10) PRIMARY KEY,
  Admin_pass VARCHAR(255),
  Access_level VARCHAR(50)
);

CREATE TABLE User_table (
  UID VARCHAR(10) PRIMARY KEY,
  F_name VARCHAR(100),
  M_Name VARCHAR(100),
  L_Name VARCHAR(100),
  Phone_no VARCHAR(20) UNIQUE NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  NID VARCHAR(100) UNIQUE NOT NULL,
  Password VARCHAR(255),
  Reg_date DATE,
  Street VARCHAR(255),
  City VARCHAR(100),
  A_Verifier VARCHAR(10),
  FOREIGN KEY (A_Verifier) REFERENCES Admin_table(Admin_ID)
);

CREATE TABLE Donor_table (
  Donor_UID VARCHAR(10) PRIMARY KEY,
  Total_donation DECIMAL(10,2),
  Last_donation DATE,
  Total_income DECIMAL(10,2),
  FOREIGN KEY (Donor_UID) REFERENCES User_table(UID)
);

CREATE TABLE Recipient_table (
  Recipient_UID VARCHAR(10) PRIMARY KEY,
  Cause TEXT,
  Donation_Goal INT,
  Last_received DATE,
  FOREIGN KEY (Recipient_UID) REFERENCES User_table(UID)
);

CREATE TABLE Saving_account (
  Recipient_UID VARCHAR(10),
  Account_no VARCHAR(10) PRIMARY KEY,
  Time_limit DATE,
  Money DECIMAL(10,2),
  FOREIGN KEY (Recipient_UID) REFERENCES User_table(UID)
);

CREATE TABLE Organization_table (
  Org_BIN INT PRIMARY KEY,
  Name VARCHAR(255),
  Branch VARCHAR(255),
  Account VARCHAR(10)
);

CREATE TABLE Total_donations (
  Donor_ID VARCHAR(10),
  Donation_no INT PRIMARY KEY,
  Donations_amount DECIMAL(10,2),
  Donation_date DATE,
  Confirmation BOOLEAN,
  FOREIGN KEY (Donor_ID) REFERENCES Donor_table(Donor_UID)
);

CREATE TABLE Receives (
  Donation_no INT,
  Recipient_UID VARCHAR(10),
  Org_BIN INT,
  Donation_date DATE,
  Donation_amount DECIMAL(10,2),
  PRIMARY KEY (Donation_no, Recipient_UID, Org_BIN),
  FOREIGN KEY (Donation_no) REFERENCES Total_donations(Donation_no),
  FOREIGN KEY (Recipient_UID) REFERENCES User_table(UID),
  FOREIGN KEY (Org_BIN) REFERENCES Organization_table(Org_BIN)
);

CREATE TABLE Financial_donations (
  Donation_no INT PRIMARY KEY,
  Money_amount DECIMAL(10,2),
  FOREIGN KEY (Donation_no) REFERENCES Total_donations(Donation_no)
);

CREATE TABLE Essential_needs (
  Donation_no INT PRIMARY KEY,
  Item_name VARCHAR(255),
  Item_quantity INT,
  FOREIGN KEY (Donation_no) REFERENCES Total_donations(Donation_no)
);

CREATE TABLE Jakat_donation (
  Donation_no INT PRIMARY KEY,
  Jakat_amount DECIMAL(10,2),
  FOREIGN KEY (Donation_no) REFERENCES Total_donations(Donation_no)
);

CREATE TABLE Feedback_table (
  UID VARCHAR(10),
  Review TEXT,
  Posting_date DATE,
  PRIMARY KEY (UID, Posting_date),
  FOREIGN KEY (UID) REFERENCES User_table(UID)
);
