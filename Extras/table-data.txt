DROP DATABASE shahajjo_db;
CREATE DATABASE shahajjo_db;
USE shahajjo_db;

CREATE TABLE admin_table (
  admin_id VARCHAR(10) PRIMARY KEY,
  admin_pass VARCHAR(255),
  access_level VARCHAR(50)
);

CREATE TABLE user_table (
  uid VARCHAR(10) PRIMARY KEY,
  f_name VARCHAR(100),
  m_name VARCHAR(100),
  l_name VARCHAR(100),
  phone_no VARCHAR(20) UNIQUE NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  nid VARCHAR(100) UNIQUE NOT NULL,
  password VARCHAR(255),
  reg_date DATE,
  street VARCHAR(255),
  city VARCHAR(100),
  a_verifier VARCHAR(10),
  FOREIGN KEY (a_verifier) REFERENCES admin_table(admin_id)
);

CREATE TABLE donor_table (
  donor_uid VARCHAR(10) PRIMARY KEY,
  total_donation DECIMAL(10,2),
  last_donation DATE,
  total_income DECIMAL(10,2),
  FOREIGN KEY (donor_uid) REFERENCES user_table(uid)
);

CREATE TABLE recipient_table (
  recipient_uid VARCHAR(10) PRIMARY KEY,
  cause TEXT,
  donation_goal INT,
  last_received DATE,
  FOREIGN KEY (recipient_uid) REFERENCES user_table(uid)
);

CREATE TABLE saving_account (
  recipient_uid VARCHAR(10),
  account_no VARCHAR(10) PRIMARY KEY,
  time_limit DATE,
  money DECIMAL(10,2),
  FOREIGN KEY (recipient_uid) REFERENCES user_table(uid)
);

CREATE TABLE organization_table (
  org_bin INT PRIMARY KEY,
  name VARCHAR(255),
  branch VARCHAR(255),
  account VARCHAR(10)
);

CREATE TABLE total_donations (
  donor_id VARCHAR(10),
  donation_no INT PRIMARY KEY,
  donations_amount DECIMAL(10,2),
  donation_date DATE,
  confirmation BOOLEAN,
  FOREIGN KEY (donor_id) REFERENCES donor_table(donor_uid)
);

CREATE TABLE receives (
  donation_no INT,
  recipient_uid VARCHAR(10),
  org_bin INT,
  donation_date DATE,
  donation_amount DECIMAL(10,2),
  PRIMARY KEY (donation_no, recipient_uid, org_bin),
  FOREIGN KEY (donation_no) REFERENCES total_donations(donation_no),
  FOREIGN KEY (recipient_uid) REFERENCES user_table(uid),
  FOREIGN KEY (org_bin) REFERENCES organization_table(org_bin)
);

CREATE TABLE financial_donations (
  donation_no INT PRIMARY KEY,
  money_amount DECIMAL(10,2),
  FOREIGN KEY (donation_no) REFERENCES total_donations(donation_no)
);

CREATE TABLE essential_needs (
  donation_no INT PRIMARY KEY,
  item_name VARCHAR(255),
  item_quantity INT,
  FOREIGN KEY (donation_no) REFERENCES total_donations(donation_no)
);

CREATE TABLE jakat_donation (
  donation_no INT PRIMARY KEY,
  jakat_amount DECIMAL(10,2),
  FOREIGN KEY (donation_no) REFERENCES total_donations(donation_no)
);

CREATE TABLE feedback_table (
  uid VARCHAR(10),
  review TEXT,
  posting_date DATE,
  PRIMARY KEY (uid, posting_date),
  FOREIGN KEY (uid) REFERENCES user_table(uid)
);

